---
import { Image } from 'astro:assets';
---

<header class="fixed top-0 left-0 right-0 z-50 bg-transparent transition-all duration-300" id="main-header">
  <nav class="container mx-auto flex items-center justify-between px-4 md:px-6 py-4">
    <a href="/" class="flex items-center gap-2">
      <Image
        src="/logo.svg"
        alt="Cuidaty"
        class="h-10 w-auto"
        width={120}
        height={40}
        loading="eager"
        decoding="async"
        format="svg"
      />
    </a>

    <div class="hidden items-center gap-8 md:flex">
      <a href="#funcionalidades" class="text-white transition-all hover:text-white font-medium drop-shadow-[0_1px_2px_rgba(0,0,0,0.5)]">
        Funcionalidades
      </a>
      <a href="#planos" class="text-white transition-all hover:text-white font-medium drop-shadow-[0_1px_2px_rgba(0,0,0,0.5)]">
        Planos
      </a>
      <a href="#sobre" class="text-white transition-all hover:text-white font-medium drop-shadow-[0_1px_2px_rgba(0,0,0,0.5)]">
        Sobre
      </a>
      <a href="#contato" class="text-white transition-all hover:text-white font-medium drop-shadow-[0_1px_2px_rgba(0,0,0,0.5)]">
        Contato
      </a>
    </div>

    <div class="flex items-center gap-3">
      <a
        href="https://app.cuidaty.com"
        class="hidden sm:inline-flex items-center gap-2 rounded-full border-2 border-white/50 px-5 py-2 font-semibold text-white backdrop-blur-sm transition-all hover:bg-white/20 hover:border-white/70 drop-shadow-[0_1px_3px_rgba(0,0,0,0.3)]"
      >
        Entrar
      </a>
      <a
        href="#contato"
        class="inline-flex items-center gap-2 rounded-full bg-white/30 backdrop-blur-sm px-6 py-2.5 font-semibold text-white border-2 border-white/50 transition-all hover:bg-white/40 hover:shadow-lg drop-shadow-[0_1px_3px_rgba(0,0,0,0.3)]"
      >
        Fale conosco
      </a>

      <!-- Mobile menu button -->
      <button
        id="mobile-menu-button"
        class="md:hidden p-2 text-white hover:text-white drop-shadow-[0_1px_2px_rgba(0,0,0,0.5)]"
        aria-label="Toggle mobile menu"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>
    </div>
  </nav>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden md:hidden border-t border-border/50 bg-background">
    <div class="container mx-auto px-4 py-4 flex flex-col gap-4">
      <a href="#funcionalidades" class="text-foreground/80 transition-colors hover:text-foreground py-2">
        Funcionalidades
      </a>
      <a href="#planos" class="text-foreground/80 transition-colors hover:text-foreground py-2">
        Planos
      </a>
      <a href="#sobre" class="text-foreground/80 transition-colors hover:text-foreground py-2">
        Sobre
      </a>
      <a href="#contato" class="text-foreground/80 transition-colors hover:text-foreground py-2">
        Contato
      </a>
      <div class="pt-4 border-t border-border/50 flex flex-col gap-3">
        <a
          href="https://app.cuidaty.com"
          class="inline-flex items-center justify-center gap-2 rounded-full border-2 border-cuidaty-primary px-5 py-2 font-medium text-cuidaty-primary transition-all hover:bg-cuidaty-primary/5"
        >
          Entrar
        </a>
        <a
          href="#contato"
          class="inline-flex items-center justify-center gap-2 rounded-full bg-cuidaty-primary px-6 py-2.5 font-semibold text-white transition-all hover:bg-cuidaty-primary-hover"
        >
          Fale conosco
        </a>
      </div>
    </div>
  </div>
</header>

<script>
  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');

  mobileMenuButton?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
  });

  // Close mobile menu when clicking on a link
  const mobileMenuLinks = mobileMenu?.querySelectorAll('a');
  mobileMenuLinks?.forEach(link => {
    link.addEventListener('click', () => {
      mobileMenu?.classList.add('hidden');
    });
  });

  // Add scroll effect to header
  const header = document.getElementById('main-header');
  let lastScroll = 0;

  window.addEventListener('scroll', () => {
    const currentScroll = window.pageYOffset;

    if (currentScroll > 100) {
      header?.classList.add('bg-white/95', 'shadow-lg', 'backdrop-blur-md');
      header?.classList.remove('bg-transparent');
      // Change text colors to dark when scrolled and remove shadow
      header?.querySelectorAll('.hidden.items-center a').forEach(link => {
        link.classList.remove('text-white', 'drop-shadow-[0_1px_2px_rgba(0,0,0,0.5)]');
        link.classList.add('text-foreground/80', 'hover:text-foreground', 'drop-shadow-none');
      });
      // Update mobile menu button
      const mobileBtn = header?.querySelector('#mobile-menu-button');
      if (mobileBtn) {
        mobileBtn.classList.remove('text-white', 'drop-shadow-[0_1px_2px_rgba(0,0,0,0.5)]');
        mobileBtn.classList.add('text-foreground/80');
      }
      // Update CTA buttons for scrolled state
      const enterBtn = header?.querySelector('a[href="https://app.cuidaty.com"]');
      const contactBtn = header?.querySelector('a[href="#contato"]:not(#mobile-menu a)');
      if (enterBtn) {
        enterBtn.classList.remove('border-white/50', 'text-white', 'hover:bg-white/20', 'hover:border-white/70', 'drop-shadow-[0_1px_3px_rgba(0,0,0,0.3)]');
        enterBtn.classList.add('border-cuidaty-primary/30', 'text-cuidaty-primary', 'hover:bg-cuidaty-primary/10', 'hover:border-cuidaty-primary/50', 'drop-shadow-none');
      }
      if (contactBtn) {
        contactBtn.classList.remove('bg-white/30', 'text-white', 'border-white/50', 'hover:bg-white/40', 'drop-shadow-[0_1px_3px_rgba(0,0,0,0.3)]');
        contactBtn.classList.add('bg-cuidaty-primary', 'text-white', 'border-cuidaty-primary', 'hover:bg-cuidaty-primary-hover', 'drop-shadow-none');
      }
    } else {
      header?.classList.remove('bg-white/95', 'shadow-lg', 'backdrop-blur-md');
      header?.classList.add('bg-transparent');
      // Change text colors back to white with shadow
      header?.querySelectorAll('.hidden.items-center a').forEach(link => {
        link.classList.add('text-white', 'drop-shadow-[0_1px_2px_rgba(0,0,0,0.5)]');
        link.classList.remove('text-foreground/80', 'hover:text-foreground', 'drop-shadow-none');
      });
      // Update mobile menu button
      const mobileBtn = header?.querySelector('#mobile-menu-button');
      if (mobileBtn) {
        mobileBtn.classList.add('text-white', 'drop-shadow-[0_1px_2px_rgba(0,0,0,0.5)]');
        mobileBtn.classList.remove('text-foreground/80');
      }
      // Restore CTA buttons for transparent state
      const enterBtn = header?.querySelector('a[href="https://app.cuidaty.com"]');
      const contactBtn = header?.querySelector('a[href="#contato"]:not(#mobile-menu a)');
      if (enterBtn) {
        enterBtn.classList.add('border-white/50', 'text-white', 'hover:bg-white/20', 'hover:border-white/70', 'drop-shadow-[0_1px_3px_rgba(0,0,0,0.3)]');
        enterBtn.classList.remove('border-cuidaty-primary/30', 'text-cuidaty-primary', 'hover:bg-cuidaty-primary/10', 'hover:border-cuidaty-primary/50', 'drop-shadow-none');
      }
      if (contactBtn) {
        contactBtn.classList.add('bg-white/30', 'text-white', 'border-white/50', 'hover:bg-white/40', 'drop-shadow-[0_1px_3px_rgba(0,0,0,0.3)]');
        contactBtn.classList.remove('bg-cuidaty-primary', 'text-white', 'border-cuidaty-primary', 'hover:bg-cuidaty-primary-hover', 'drop-shadow-none');
      }
    }

    lastScroll = currentScroll;
  });
</script>
